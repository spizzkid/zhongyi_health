---
const images = [
  {
    src: "/image/beijing/幻灯片1.PNG",
    title: "专业医师团队",
    description: "拥有多年临床经验的中医专家团队"
  },
  {
    src: "/image/beijing/幻灯片2.PNG",
    title: "现代化设备",
    description: "配备先进的中医诊疗设备"
  },
  {
    src: "/image/beijing/幻灯片3.PNG",
    title: "治疗环境",
    description: "舒适优雅的诊疗环境"
  },
  {
    src: "/image/beijing/幻灯片4.PNG",
    title: "康复指导",
    description: "专业的康复训练和健康指导"
  },
  {
    src: "/image/beijing/幻灯片5.PNG",
    title: "中医诊疗",
    description: "结合传统中医理论与现代医学技术，为您提供全面的健康诊疗服务"
  },
  {
    src: "/image/beijing/幻灯片6.PNG",
    title: "康复理疗",
    description: "专业的康复训练和理疗服务，帮助您恢复健康"
  },
  {
    src: "/image/beijing/幻灯片7.PNG",
    title: "健康咨询",
    description: "提供专业的健康咨询和指导，为您定制个性化的健康方案"
  }
];
---

<div class="relative h-[200px] sm:h-[300px] md:h-[500px] lg:h-[720px] bg-gray-200 rounded-xl overflow-hidden group">
  <div class="carousel-container w-full h-full">
    {images.map((image, index) => (
      <div class="carousel-slide absolute w-full h-full opacity-0 transition-opacity duration-1000" data-index={index}>
        <img src={image.src} alt={image.title} class="w-full h-full object-contain md:object-cover" />
        <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-3 md:p-6 text-white">
          <h3 class="text-lg md:text-2xl font-bold mb-1 md:mb-2">{image.title}</h3>
          <p class="text-sm md:text-lg">{image.description}</p>
        </div>
      </div>
    ))}
  </div>
  
  <!-- 左右导航按钮 -->
  <button class="carousel-prev absolute left-4 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-black/50 hover:bg-black/70 flex items-center justify-center text-white transition-all shadow-lg hover:scale-110">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M15 19l-7-7 7-7" />
    </svg>
  </button>
  <button class="carousel-next absolute right-4 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-black/50 hover:bg-black/70 flex items-center justify-center text-white transition-all shadow-lg hover:scale-110">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 5l7 7-7 7" />
    </svg>
  </button>
  
  <!-- 底部导航点 -->
  <div class="absolute bottom-4 left-0 right-0 flex justify-center gap-2">
    {images.map((_, index) => (
      <button
        class="w-2 h-2 rounded-full bg-white/50 hover:bg-white/80 transition-colors carousel-dot"
        data-index={index}
        aria-label={`Slide ${index + 1}`}
      ></button>
    ))}
  </div>
</div>

<script>
  function setupCarousel() {
    const slides = document.querySelectorAll('.carousel-slide');
    const dots = document.querySelectorAll('.carousel-dot');
    const prevButton = document.querySelector('.carousel-prev');
    const nextButton = document.querySelector('.carousel-next');
    let currentSlide = 0;
    const slideCount = slides.length;
    let intervalId: ReturnType<typeof setInterval>;

    function showSlide(index: number) {
      slides.forEach((slide) => {
        (slide as HTMLElement).style.opacity = '0';
      });
      dots.forEach((dot) => {
        dot.classList.remove('bg-white');
        dot.classList.add('bg-white/50');
      });

      (slides[index] as HTMLElement).style.opacity = '1';
      dots[index].classList.remove('bg-white/50');
      dots[index].classList.add('bg-white');
      currentSlide = index;
    }

    function nextSlide() {
      showSlide((currentSlide + 1) % slideCount);
    }

    function prevSlide() {
      showSlide((currentSlide - 1 + slideCount) % slideCount);
    }

    function startAutoPlay() {
      intervalId = setInterval(nextSlide, 3000);
    }

    function stopAutoPlay() {
      clearInterval(intervalId);
    }

    function resetAutoPlay() {
      stopAutoPlay();
      startAutoPlay();
    }

    // 初始化显示第一张
    showSlide(0);

    // 点击导航点切换
    dots.forEach((dot, index) => {
      dot.addEventListener('click', () => {
        showSlide(index);
        resetAutoPlay();
      });
    });

    // 点击左右按钮切换
    prevButton?.addEventListener('click', () => {
      prevSlide();
      resetAutoPlay();
    });

    nextButton?.addEventListener('click', () => {
      nextSlide();
      resetAutoPlay();
    });

    // 鼠标悬停时暂停自动播放
    const container = document.querySelector('.carousel-container');
    container?.addEventListener('mouseenter', stopAutoPlay);
    container?.addEventListener('mouseleave', startAutoPlay);

    // 开始自动播放
    startAutoPlay();
  }

  // 当页面加载完成时初始化轮播
  document.addEventListener('astro:page-load', setupCarousel);
  // 为了确保在首次加载时也能运行
  setupCarousel();
</script> 